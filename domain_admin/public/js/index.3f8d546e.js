import{_ as x,u as b}from"./index.2e927656.js";import{a5 as a,o as y,c as g,X as e,R as s,a as d,W as C,Z as f,ay as S,az as D}from"./vendor-vue.e07d7f7e.js";import"./element-icon.bb5f2c38.js";import"./vendor-lib.bb870261.js";import"./element-plus.93c2f37e.js";const I={};function R(){let o=URL.createObjectURL(new Blob),t=o.toString();return URL.revokeObjectURL(o),t.substring(t.lastIndexOf("/")+1)}const V={name:"",props:{row:{type:Object,default:null}},components:{},data(){return{rules:I,form:{username:"",avatar_url:"",before_expire_days:0,email_list:""}}},computed:{},methods:{async getData(){const o=await this.$http.getUserInfo();if(o.code!=0)return;let t=o.data;this.form.username=t.username,this.form.avatar_url=t.avatar_url,this.form.before_expire_days=t.before_expire_days,this.form.email_list=t.email_list.join(`
`)},handleCancel(){this.$emit("on-cancel")},handleRandomAvatar(){let o=R();this.form.avatar_url="https://api.multiavatar.com/"+o+".png?apikey=mXMn18VQJxoH0P"},handleSubmit(){this.$refs.form.validate(o=>{if(o)this.confirmSubmit();else return!1})},async confirmSubmit(){let o=this.$loading({fullscreen:!0}),t=[];this.form.email_list&&this.form.email_list.trim()&&(t=this.form.email_list.trim().split(`
`));let p={avatar_url:this.form.avatar_url,before_expire_days:this.form.before_expire_days,email_list:t};const i=await this.$http.updateUserInfo(p);i.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(i.msg),this.$nextTick(()=>{o.close()})}},created(){this.getData()}},w=d("img",{src:"https://api.multiavatar.com/domain-admin.png"},null,-1),L={class:"text-center"};function O(o,t,p,i,n,l){const r=a("el-form-item"),c=a("el-avatar"),m=a("Refresh"),u=a("el-icon"),_=a("el-button"),v=a("el-input-number"),$=a("el-input"),k=a("el-form"),U=a("Select");return y(),g("div",null,[e(k,{ref:"form",model:n.form,rules:n.rules,"label-width":"160px"},{default:s(()=>[e(r,{label:"\u7528\u6237\u540D",prop:"username"},{default:s(()=>[d("span",null,C(n.form.username),1)]),_:1}),e(r,{label:"\u5934\u50CF",prop:"avatar_url"},{default:s(()=>[e(c,{src:n.form.avatar_url},{default:s(()=>[w]),_:1},8,["src"]),e(_,{class:"ml-md",onClick:l.handleRandomAvatar},{default:s(()=>[e(u,null,{default:s(()=>[e(m)]),_:1}),f("\u968F\u673A\u83B7\u53D6")]),_:1},8,["onClick"])]),_:1}),e(r,{label:"\u8FC7\u671F\u524D\u591A\u5C11\u5929\u63D0\u9192",prop:"before_expire_days"},{default:s(()=>[e(v,{modelValue:n.form.before_expire_days,"onUpdate:modelValue":t[0]||(t[0]=h=>n.form.before_expire_days=h),min:0,placeholder:"\u8BF7\u8F93\u5165\u8FC7\u671F\u524D\u591A\u5C11\u5929\u63D0\u9192"},null,8,["modelValue"])]),_:1}),e(r,{label:"\u6536\u4EF6\u90AE\u7BB1",prop:"email_list"},{default:s(()=>[e($,{type:"textarea",rows:5,modelValue:n.form.email_list,"onUpdate:modelValue":t[1]||(t[1]=h=>n.form.email_list=h),placeholder:"\u90AE\u7BB1\u5217\u8868\uFF0C\u6BCF\u884C\u4E00\u4E2A"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),d("div",L,[e(_,{type:"primary",onClick:l.handleSubmit},{default:s(()=>[e(u,null,{default:s(()=>[e(U)]),_:1}),f("\u4FDD \u5B58")]),_:1},8,["onClick"])])])}const P=x(V,[["render",O]]),j={name:"user-edit",props:{},components:{DataForm:P},data(){return{id:null}},computed:{...S(b,{userInfo:"userInfo"})},methods:{...D(b,{updateUserInfo:"updateUserInfo"}),handleSuccess(){this.updateUserInfo()},async sendDomainInfoListEmail(){let o=this.$loading({fullscreen:!0});try{(await this.$http.sendDomainInfoListEmail()).code==0&&(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success"))}catch{}finally{this.$nextTick(()=>{o.close()})}},async checkDomainCert(){let o=this.$loading({fullscreen:!0});try{(await this.$http.checkDomainCert()).code==0&&(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success"))}catch{}finally{this.$nextTick(()=>{o.close()})}}},created(){this.id=this.$route.query.id}},B={class:"app-container"},E={class:"flex"};function T(o,t,p,i,n,l){const r=a("Position"),c=a("el-icon"),m=a("el-button"),u=a("Promotion"),_=a("DataForm");return y(),g("div",B,[d("div",E,[e(m,{class:"margin-left--auto",onClick:l.sendDomainInfoListEmail},{default:s(()=>[e(c,null,{default:s(()=>[e(r)]),_:1}),f("\u53D1\u9001\u90AE\u4EF6")]),_:1},8,["onClick"]),e(m,{class:"margin-left--auto",onClick:l.checkDomainCert},{default:s(()=>[e(c,null,{default:s(()=>[e(u)]),_:1}),f("\u8BC1\u4E66\u68C0\u67E5")]),_:1},8,["onClick"])]),e(_,{class:"mt-md",onOnSuccess:l.handleSuccess},null,8,["onOnSuccess"])])}const z=x(j,[["render",T]]);export{z as default};
